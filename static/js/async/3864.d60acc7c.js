"use strict";(self.webpackChunkrebuild_vue3_vant4=self.webpackChunkrebuild_vue3_vant4||[]).push([["3864"],{1972:function(e,t,l){l.r(t),l.d(t,{default:()=>E});var a=l(4210);l(8246);var s=l(4936);l(276);var r=l(1346);l(3974);var n=l(9155);l(3720);var i=l(6653);l(5161);var u=l(3919);l(5454);var c=l(796),o=l(9395),d=l(6265),v=l(2250),_=l(4496),p=l(1277),b=l(352);l(7307);var w=l(2991);l(8491);let g={class:"top"},h={class:"time"},m={class:"time-content"},S={class:"value"},k={class:"value"},U={class:"value"},f={class:"page"},y={class:"container"},H={key:0},M={class:"list-top"},D={class:"list-title"},C={class:"progress"},N={class:"list-btm"},x={key:2,class:"rule_html"},z=["innerHTML"],q={class:"popup-box"},L={class:"popup-box-cont"},j=["innerHTML"],I={class:"popup-box-button"},T=(0,c.aZ)({__name:"LossRate",emits:["loadData"],setup(e,t){let{emit:T}=t;(0,_.A)();let E=(0,c.iH)(!1),W=(0,c.iH)([]),A=(0,c.iH)(),F=(0,c.iH)(!1),K=(e,t)=>{t.sort((e,t)=>Number(e.loss)-Number(t.loss));let l=t[t.length-1];for(let l=0;l<t.length;l++)if(Number(t[l].loss)<=e&&(F.value=!0),Number(t[l].loss)>=e)return{remainingDays:Number(t[l].loss),points:t[l].reward};return{remainingDays:Number(l.loss),points:l.reward}};(0,c.Fl)(()=>W.value.length>0?K(W.value[0].currentCount<=0?Math.abs(W.value[0].currentCount):0,W.value[0].rule_list):{remainingDays:0,points:0});let Y=(e,t)=>{let l=e<=0?Math.abs(e):0;return l/Number(t)*100>100?100:l/Number(t)*100||0},R=(e,t)=>{let l=e<=0?Math.abs(e):0;return l>=Number(t)?Number(t):l},Z=(e,t,l)=>{let a=e<=0?Math.abs(e):0,s=Number(l.loss);return a<s?0:s===Math.max(...t.map(e=>Number(e.loss)).filter(e=>a>=e))?2:1},B=async e=>{200===(await (0,b.R9)({a_id:e})).code&&(0,w.XA)({message:"领取成功",onClose:()=>{G()}})},G=async()=>{P&&(clearInterval(P),P=null);let e=await (0,b.K3)({type:"lose_rate"});200===e.code&&e.data&&(W.value=e.data,X.value=e.data[0].cycle?e.data[0].cycle:"",e.data[0].cycle&&(X.value=e.data[0].cycle||"day",Q(),P=setInterval(Q,6e4)))},X=(0,c.iH)("day"),$=(0,c.iH)("00"),J=(0,c.iH)("00"),O=(0,c.iH)("00"),P=null;function Q(){let e=(function(e){let t=new Date,l=new Date(t);switch(e){case"day":l.setHours(23,59,59,999);break;case"week":let a=t.getDay();l.setDate(t.getDate()+(0===a?0:7-a)),l.setHours(23,59,59,999);break;case"month":l.setMonth(l.getMonth()+1,0),l.setHours(23,59,59,999);break;case"quarter":let s=3*Math.floor(t.getMonth()/3)+2;l.setMonth(s+1,0),l.setHours(23,59,59,999);break;case"year":l.setMonth(11,31),l.setHours(23,59,59,999)}return l})(X.value).getTime()-Date.now();if(e<=0){$.value="00",J.value="00",O.value="00";return}let t=Math.floor(e/6e4),l=Math.floor(t/1440),a=Math.floor(t%1440/60);$.value=String(l).padStart(2,"0"),J.value=String(a).padStart(2,"0"),O.value=String(t%60).padStart(2,"0")}return(0,c.bv)(()=>{G()}),(0,c.SK)(()=>{P&&clearInterval(P)}),(e,t)=>{let _=u.l2,b=i.Ee,w=n.zx,T=r.Ex,F=s.HY,K=a.GI;return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c.Wm)(_,{class:"header","safe-area-inset-top":"",border:!1,fixed:"","z-index":"2","left-arrow":!1,placeholder:"",onClickLeft:t[0]||(t[0]=e=>(0,c.SU)(p.Z).back())},{left:(0,c.w5)(()=>t[4]||(t[4]=[(0,c._)("img",{src:o,alt:"icon",class:"back-icon"},null,-1)])),title:(0,c.w5)(()=>t[5]||(t[5]=[(0,c._)("p",{class:"title"},"每日救援金",-1)])),_:1}),(0,c._)("div",g,[(0,c._)("div",h,[t[9]||(t[9]=(0,c._)("span",{class:"time-title"},[(0,c._)("span",{class:"line"}),(0,c._)("span",null,"倒计时"),(0,c._)("span",{class:"line"})],-1)),(0,c._)("span",m,[(0,c._)("span",S,(0,c.zw)((0,c.SU)($)),1),t[6]||(t[6]=(0,c._)("span",null,"天",-1)),(0,c._)("span",k,(0,c.zw)((0,c.SU)(J)),1),t[7]||(t[7]=(0,c._)("span",null,"时",-1)),(0,c._)("span",U,(0,c.zw)((0,c.SU)(O)),1),t[8]||(t[8]=(0,c._)("span",null,"分",-1))])])]),(0,c._)("div",f,[(0,c._)("div",y,[(0,c.SU)(W).length>0?((0,c.wg)(),(0,c.iD)("div",H,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)((0,c.SU)(W)[0].rule_list,(e,a)=>((0,c.wg)(),(0,c.iD)("div",{class:"list",key:a},[(0,c._)("div",M,[(0,c._)("div",null,[(0,c._)("div",D,[(0,c._)("span",null,"亏损"+(0,c.zw)(e.loss)+"送"+(0,c.zw)(e.reward),1)])]),"1"==(0,c.SU)(W)[0].status&&0===(0,c.SU)(W)[0].receive&&0==Z((0,c.SU)(W)[0].currentCount,(0,c.SU)(W)[0].rule_list,e)?((0,c.wg)(),(0,c.j4)(b,{key:0,width:"72",src:l(8214)},null,8,["src"])):(0,c.kq)("",!0),1==Z((0,c.SU)(W)[0].currentCount,(0,c.SU)(W)[0].rule_list,e)&&"1"==(0,c.SU)(W)[0].status&&0===(0,c.SU)(W)[0].receive?((0,c.wg)(),(0,c.j4)(w,{key:1,block:"",round:"",class:"cancel_btn"},{default:(0,c.w5)(()=>t[10]||(t[10]=[(0,c.Uk)(" 立即领取 ")])),_:1})):(0,c.kq)("",!0),"1"==(0,c.SU)(W)[0].status&&0===(0,c.SU)(W)[0].receive&&2==Z((0,c.SU)(W)[0].currentCount,(0,c.SU)(W)[0].rule_list,e)?((0,c.wg)(),(0,c.j4)(b,{key:2,onClick:t[1]||(t[1]=e=>B((0,c.SU)(W)[0].id)),width:"72",src:l(8299)},null,8,["src"])):(0,c.kq)("",!0),1===(0,c.SU)(W)[0].receive&&2==Z((0,c.SU)(W)[0].currentCount,(0,c.SU)(W)[0].rule_list,e)?((0,c.wg)(),(0,c.j4)(b,{key:3,width:"72",src:l(3243)},null,8,["src"])):(0,c.kq)("",!0)]),(0,c._)("div",C,[(0,c.Wm)(T,{percentage:Y((0,c.SU)(W)[0].currentCount,e.loss),"track-color":"#352918",color:"linear-gradient(90deg, rgba(255, 255, 255, 0.00) 86.33%, rgba(255, 255, 255, 0.70) 99.72%), linear-gradient(180deg, #F3E295 0%, #AB6E0F 100%)","stroke-width":"14","show-pivot":!1},null,8,["percentage"])]),(0,c._)("div",N,[(0,c._)("div",null,[t[11]||(t[11]=(0,c.Uk)("当前亏损：")),(0,c._)("span",null,"-"+(0,c.zw)(R((0,c.SU)(W)[0].currentCount,e.loss)),1)])])]))),128))])):((0,c.wg)(),(0,c.j4)(F,{key:1,description:"暂无活动"})),t[12]||(t[12]=(0,c._)("div",{class:"box-title"},[(0,c._)("div",{class:"title-left"}),(0,c._)("p",null,"活动规则")],-1)),(0,c.SU)(W).length>0?((0,c.wg)(),(0,c.iD)("div",x,[(0,c._)("div",{innerHTML:(0,c.SU)(W)[0].activityDescribe},null,8,z)])):(0,c.kq)("",!0)])]),(0,c.Wm)(K,{show:(0,c.SU)(E),"onUpdate:show":t[3]||(t[3]=e=>(0,c.dq)(E)?E.value=e:null),class:"popup",position:"center"},{default:(0,c.w5)(()=>[(0,c._)("div",q,[t[13]||(t[13]=(0,c._)("div",{class:"popup-box-title"},[(0,c._)("img",{src:d,alt:"icon"}),(0,c._)("h3",null,"活动规则"),(0,c._)("img",{src:v,alt:"icon"})],-1)),(0,c._)("div",L,[(0,c._)("div",{innerHTML:(0,c.SU)(A)},null,8,j)]),(0,c._)("div",I,[(0,c.Wm)(w,{block:"",round:"",class:"btn",onClick:t[2]||(t[2]=e=>E.value=!1)},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.$t("binding.confirm")),1)]),_:1})])])]),_:1},8,["show"])],64)}}}),E=(0,l(3744).default)(T,[["__scopeId","data-v-120415ce"]])}}]);